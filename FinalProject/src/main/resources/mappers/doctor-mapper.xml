<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Doctor">
	
	<resultMap id="MedicalMap" type="Medical">
		<id property="mCode" column="M_CODE"/>
		<result property="pNo" column="P_NO"/>
		<result property="mDate" column="M_DATE"/>
		<result property="empNo" column="EMP_NO"/>
		<result property="mHistory" column="M_HISTORY"/>
	</resultMap>
	
	<resultMap id="medicineMap" type="medicine">
		<id property="medCode" column="MED_CODE"/>
		<result property="medName" column="MED_NAME"/>
		<result property="medCount" column="MED_COUNT"/>
	</resultMap>
	
	<select id="patientList" resultType="Patient">
		SELECT * FROM PATIENT WHERE P_ACC_YN = 'Y' AND P_MEDICAL_YN = 'N' ORDER BY P_NO ASC
	</select>
	
	<select id="medicineList" resultMap="medicineMap">
		SELECT * FROM MEDICINE ORDER BY MED_CODE ASC
	</select>
	
	<select id="medicalCode" resultType="string">
		SELECT CONCAT('22MDC', SEQ_M_CODE.NEXTVAL) FROM DUAL
	</select>
	
	<insert id="medicalSave" parameterType="Medical">
		INSERT INTO MEDICAL VALUES(#{mCode}, #{mHistory}, #{pNo}, #{mDate}, #{empNo})
	</insert>
	
	<update id="admissionY" parameterType="_int">
		UPDATE PATIENT SET P_ADMISSION_YN = 'Y' WHERE P_NO = #{pNo}
	</update>
	
	<insert id="insertACC" parameterType="Medical">
		INSERT INTO ACCEPTANCE VALUES(SEQ_ACC_NO.NEXTVAL, #{pNo}, #{mCode}, DEFAULT, DEFAULT)
	</insert>
	
	<update id="medicalY" parameterType="_int">
		UPDATE PATIENT SET P_MEDICAL_YN = 'Y' WHERE P_NO = #{pNo}
	</update>
	
	<select id="patientListAll" resultType="Patient">
		SELECT * FROM PATIENT ORDER BY P_NO ASC
	</select>
	
	<select id="patientOne" parameterType="hashmap" resultType="Patient">
		SELECT * FROM PATIENT WHERE P_NAME = #{pName} AND P_RRN = #{pRrn}
	</select>
	
</mapper>
