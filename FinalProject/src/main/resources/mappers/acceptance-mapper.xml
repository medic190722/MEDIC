<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="acceptance">

	<resultMap id="resultPatient" type="Patient">
		<result property="p_phone" column="p_phone" typeHandler="strArrPhoneTypeHandler"/>		
	</resultMap>
	
	<select id="selectPatient" parameterType="string" resultMap="resultPatient">
		SELECT P.*, M.M_CODE 
		FROM PATIENT P 
		JOIN MEDICAL M ON(P.P_NO = M.P_NO) 
		WHERE M.P_NO IN(SELECT P_NO FROM PATIENT WHERE P_NAME LIKE CONCAT(CONCAT('%',#{p_name}),'%'))
	</select>
		
	<select id="selectPayPatient" parameterType="_int" resultMap="resultPatient">
		SELECT P.*, M.M_CODE, M.M_HISTORY
		FROM PATIENT P
		JOIN MEDICAL M ON(P.P_NO = M.P_NO)
		WHERE M.P_NO = #{p_no}
	</select>
	
</mapper>
